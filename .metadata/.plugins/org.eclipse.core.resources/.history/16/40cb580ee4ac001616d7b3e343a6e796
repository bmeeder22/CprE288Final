/*
 * main.c
 */
#include "api/WiFi.h"
#include "api/lcd.h"
#include "api/uart.h"
#include "api/Timer.h"
#include "api/servo.h"
#include "api/ir.h"
#include "api/sonar.h"
#include <string.h>
#include <math.h>

#define	M_PI		3.14159265358979323846

void init_all();
void handleCommand(char in);

int degree;
int degrees = 180;
int objCount = 0;
int smallestLocation = 10000;
int smallestWidth = 10000;

int main(void) {
	init_all();

	while(1){
		char in = uart_receive();
		handleCommand(in);
	}
}

void handleCommand(char in) {
	if(in == 'f') {
		lcd_printf("%s", "FORWARD");
		uart_sendStr("FORWARD");
	}
	if(in == 'b') {
		lcd_printf("%s", "BACKWARDS");
		uart_sendStr("BACKWARDS");
	}
	if(in == 'l') {
		lcd_printf("%s", "LEFT");
		uart_sendStr("LEFT");
	}
	if(in == 'r') {
		lcd_printf("%s", "RIGHT");
		uart_sendStr("RIGHT");
	}
	if(in == 's') {
		uart_sendStr("start_sweep");
		sweep();
		uart_sendStr("end_sweep");
	}
}

void init_all() {
	lcd_init();
    sonar_timer_init();
	ir_timer_init();
	servo_timer_init();
	uart_init();

//	WiFi_start("aaaaaaaa\0");
//	while(1) {}
}
